---
import BaseHead from "../../../components/BaseHead.astro";
import Header from "../../../components/Header.astro";
import Footer from "../../../components/Footer.astro";
import PostList from "../../../components/PostList.astro";

import { PUBLIC_ZENBLOG_BLOG_ID } from "astro:env/client";
import { createZenblogClient } from "zenblog";

const { slug } = Astro.params;
if (!PUBLIC_ZENBLOG_BLOG_ID) throw new Error("Missing PUBLIC_ZENBLOG_BLOG_ID");

const client = createZenblogClient({ blogId: PUBLIC_ZENBLOG_BLOG_ID });
const posts = await client.posts.list({ category: slug });
const categories = await client.categories.list();
const currentCategory = categories.find((c) => c.slug === slug);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={currentCategory?.name ?? slug} description="" />
  </head>
  <body>
    <Header />
    <main>â€¦</main>
    <PostList posts={posts.data} />
    <Footer />
  </body>
</html>
